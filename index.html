<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Unjumble the Sentence</title>
  <link href="https://fonts.googleapis.com/css2?family=Nico+Moji&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Nico Moji', sans-serif;
      background: linear-gradient(to bottom, #ffe3e3, #f5f5dc);
      margin: 0;
      padding: 0;
      text-align: center;
    }
    #start-screen, #game-screen {
      display: none;
      padding: 20px;
    }
    #start-screen.active, #game-screen.active {
      display: block;
    }
    h1 {
      font-size: 2.5em;
      margin: 1rem;
      background: #ffd6ec;
      padding: 10px;
      border-radius: 20px;
      display: inline-block;
    }
    .grammar-button {
      font-size: 1.2rem;
      margin: 10px;
      padding: 10px 20px;
      cursor: pointer;
      border: none;
      border-radius: 10px;
      background: #a2d2ff;
    }
    #word-bank, #drop-zone {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin: 20px;
    }
    .word {
      font-size: 2rem;
      padding: 10px 20px;
      cursor: grab;
      border-radius: 15px;
      background: #fff8dc;
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);
      user-select: none;
      transition: transform 0.2s ease;
    }
    .word:active {
      transform: scale(1.1);
    }
    .word.correct {
      background-color: #d4edda;
      color: green;
    }
    .word.wrong {
      background-color: #f8d7da;
      color: red;
    }
    button {
      font-size: 1rem;
      margin: 10px;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 10px;
      background-color: #ffdac1;
    }
    #tick {
      font-size: 3rem;
      color: green;
      display: none;
      animation: pop 0.5s ease-in-out;
    }
    #score {
      font-size: 1.2rem;
      margin-top: 10px;
    }
    #translation {
      font-size: 1.5rem;
      color: #555;
      margin-bottom: 10px;
    }
    #mission-tracker {
      margin: 10px;
      font-size: 1rem;
      color: #333;
    }
    .word-slot {
      min-width: 100px;
      min-height: 40px;
      margin: 5px;
      border-bottom: 2px dashed #ccc;
      border-radius: 10px;
    }
    @keyframes pop {
      0% {
        transform: scale(0);
        opacity: 0;
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }
  </style>
</head>
<body>
  <div id="start-screen" class="active">
    <h1>ÊñáÊ≥ï„ÇíÈÅ∏„Åº„ÅÜ</h1>
    <div>
      <button class="grammar-button" onclick="startGame('future')">Êú™Êù•ÂΩ¢</button>
      <button class="grammar-button" onclick="startGame('if')">„ÇÇ„Åó‚Ä¶</button>
      <button class="grammar-button" onclick="startGame('when')">„Äú„Åô„Çã„Å®„Åç</button>
      <button class="grammar-button" onclick="startGame('think')">‚Ä¶„Å®ÊÄù„ÅÜ</button>
      <button class="grammar-button" onclick="startGame('want')">„Åô„Çã„Åì„Å®Ôºë</button>
      <button class="grammar-button" onclick="startGame('purpose')">„Åô„Çã„Åì„Å®Ôºí</button>
      <button class="grammar-button" onclick="startGame('must')">„Åó„Å™„Åë„Çå„Å∞„Å™„Çâ„Å™„ÅÑ</button>
      <button class="grammar-button" onclick="startGame('mustNot')">„Åó„Å¶„ÅØ„ÅÑ„Åë„Å™„ÅÑ</button>
    </div>
  </div>

  <div id="game-screen">
    <h1 id="game-title"></h1>
    <div id="translation"></div>
    <div id="drop-zone"></div>
    <div id="word-bank"></div>
    <button onclick="showHint()">üí° Hint</button>
    <button onclick="replayAudio()">üîä Replay</button>
    <button id="nextBtn" onclick="nextSentence()" style="display:none;">‚û°Ô∏è Next</button>
    <div id="tick">‚úîÔ∏è</div>
    <div id="score"></div>
    <div id="mission-tracker"></div>
  </div>

  <script>
    const sentenceSets = {
      future: [
        { en: "I will play soccer tomorrow", jp: "ÁßÅ„ÅØÊòéÊó•„Çµ„ÉÉ„Ç´„Éº„Çí„Åó„Åæ„Åô" },
        { en: "She will visit her grandmother next week", jp: "ÂΩºÂ•≥„ÅØÊù•ÈÄ±„Åä„Å∞„ÅÇ„Åï„Çì„ÇíË®™„Çå„Åæ„Åô" },
        { en: "They will have lunch at noon", jp: "ÂΩº„Çâ„ÅØÊ≠£Âçà„Å´Êòº„Åî„ÅØ„Çì„ÇíÈ£ü„Åπ„Åæ„Åô" }
      ],
      if: [
        { en: "If it rains, I will stay home", jp: "„ÇÇ„ÅóÈõ®„ÅåÈôç„Å£„Åü„Çâ„ÄÅÂÆ∂„Å´„ÅÑ„Åæ„Åô" },
        { en: "If I study, I will pass the test", jp: "„ÇÇ„ÅóÂãâÂº∑„Åô„Çå„Å∞„ÄÅ„ÉÜ„Çπ„Éà„Å´ÂêàÊ†º„Åó„Åæ„Åô" },
        { en: "If she calls, tell me", jp: "„ÇÇ„ÅóÂΩºÂ•≥„ÅåÈõªË©±„Åó„Åü„Çâ„ÄÅÊïô„Åà„Å¶„Åè„Å†„Åï„ÅÑ" }
      ],
      when: [
        { en: "I wash my hands when I get home", jp: "ÂÆ∂„Å´Â∏∞„Çã„Å®„Åç„ÄÅÊâã„ÇíÊ¥ó„ÅÑ„Åæ„Åô" },
        { en: "When it is sunny, we play outside", jp: "Êô¥„Çå„ÅÆ„Å®„Åç„ÄÅÂ§ñ„ÅßÈÅä„Å≥„Åæ„Åô" },
        { en: "He reads a book when he waits", jp: "ÂæÖ„Å£„Å¶„ÅÑ„Çã„Å®„Åç„ÄÅÊú¨„ÇíË™≠„Åø„Åæ„Åô" }
      ],
      think: [
        { en: "I think it will rain tomorrow", jp: "ÊòéÊó•„ÅØÈõ®„ÅåÈôç„Çã„Å®ÊÄù„ÅÑ„Åæ„Åô" },
        { en: "She thinks the test is hard", jp: "ÂΩºÂ•≥„ÅØ„ÉÜ„Çπ„Éà„ÅåÈõ£„Åó„ÅÑ„Å®ÊÄù„ÅÑ„Åæ„Åô" },
        { en: "They think this movie is fun", jp: "ÂΩº„Çâ„ÅØ„Åì„ÅÆÊò†Áîª„ÅØÊ•Ω„Åó„ÅÑ„Å®ÊÄù„ÅÑ„Åæ„Åô" }
      ],
      want: [  // „Åô„Çã„Åì„Å®Ôºë: I want to go type
        { en: "I want to go to Japan", jp: "Êó•Êú¨„Å´Ë°å„Åç„Åü„ÅÑ„Åß„Åô" },
        { en: "He wants to eat sushi", jp: "ÂΩº„ÅØÂØøÂè∏„ÇíÈ£ü„Åπ„Åü„ÅÑ„Åß„Åô" },
        { en: "We want to watch a movie", jp: "ÁßÅ„Åü„Å°„ÅØÊò†Áîª„ÇíË¶ã„Åü„ÅÑ„Åß„Åô" }
      ],
      purpose: [  // „Åô„Çã„Åì„Å®Ôºí: I use plastic to save the environment type
        { en: "I use plastic to save the environment", jp: "Áí∞Â¢É„ÇíÂÆà„Çã„Åü„ÇÅ„Å´„Éó„É©„Çπ„ÉÅ„ÉÉ„ÇØ„Çí‰Ωø„ÅÑ„Åæ„Åô" },
        { en: "She studies hard to pass the exam", jp: "ÂΩºÂ•≥„ÅØË©¶È®ì„Å´ÂêàÊ†º„Åô„Çã„Åü„ÇÅ„Å´‰∏ÄÁîüÊá∏ÂëΩÂãâÂº∑„Åó„Åæ„Åô" },
        { en: "They recycle to protect the earth", jp: "ÂΩº„Çâ„ÅØÂú∞ÁêÉ„ÇíÂÆà„Çã„Åü„ÇÅ„Å´„É™„Çµ„Ç§„ÇØ„É´„Åó„Åæ„Åô" }
      ],
      must: [
        { en: "I must finish my homework", jp: "ÂÆøÈ°å„ÇíÁµÇ„Åà„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì" },
        { en: "You must wear a uniform", jp: "Âà∂Êúç„ÇíÁùÄ„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì" },
        { en: "We must clean the classroom", jp: "ÊïôÂÆ§„ÇíÊéÉÈô§„Åó„Å™„Åë„Çå„Å∞„Å™„Çä„Åæ„Åõ„Çì" }
      ],
      mustNot: [
        { en: "You must not talk in class", jp: "ÊéàÊ•≠‰∏≠„Å´Ë©±„Åó„Å¶„ÅØ„ÅÑ„Åë„Åæ„Åõ„Çì" },
        { en: "He must not use his phone", jp: "ÂΩº„ÅØÈõªË©±„Çí‰Ωø„Å£„Å¶„ÅØ„ÅÑ„Åë„Åæ„Åõ„Çì" },
        { en: "They must not eat here", jp: "„Åì„Åì„ÅßÈ£ü„Åπ„Å¶„ÅØ„ÅÑ„Åë„Åæ„Åõ„Çì" }
      ],
    };

    let currentSet = [];
    let sentence = "";
    let words = [];
    let score = 0;
    let totalSentences = 0;
    const dropZone = document.getElementById("drop-zone");
    const wordBank = document.getElementById("word-bank");
    const tick = document.getElementById("tick");
    const gameTitle = document.getElementById("game-title");
    const scoreDisplay = document.getElementById("score");
    const translation = document.getElementById("translation");
    const missionTracker = document.getElementById("mission-tracker");

    function startGame(setName) {
      document.getElementById("start-screen").classList.remove("active");
      document.getElementById("game-screen").classList.add("active");
      gameTitle.textContent = setName;
      currentSet = sentenceSets[setName];
      score = 0;
      totalSentences = 0;
      scoreDisplay.innerHTML = "üçì 0 points";
      missionTracker.textContent = `Mission: 0 / ${currentSet.length} sentences`;
      nextSentence();
    }

    function nextSentence() {
      const entry = currentSet[Math.floor(Math.random() * currentSet.length)];
      sentence = entry.en;
      words = sentence.split(" ");
      let shuffled = [...words].sort(() => Math.random() - 0.5);
      dropZone.innerHTML = "";
      wordBank.innerHTML = "";
      translation.textContent = entry.jp;
      tick.style.display = "none";
      document.getElementById("nextBtn").style.display = "none";

      // Create drop slots
      for (let i = 0; i < words.length; i++) {
        const slot = document.createElement("div");
        slot.classList.add("word-slot");
        slot.ondragover = e => e.preventDefault();
        slot.ondrop = function (e) {
          e.preventDefault();
          const data = e.dataTransfer.getData("text");
          const draggedEl = [...wordBank.children].find(el => el.textContent === data);
          if (draggedEl && slot.children.length === 0) {
            slot.appendChild(draggedEl);
            checkAnswer();
          }
        };
        dropZone.appendChild(slot);
      }

      // Add shuffled words to word bank
      shuffled.forEach(word => {
        const el = document.createElement("div");
        el.textContent = word;
        el.classList.add("word");
        el.draggable = true;
        el.addEventListener("dragstart", dragStart);
        wordBank.appendChild(el);
      });
    }

    function dragStart(e) {
      e.dataTransfer.setData("text", e.target.textContent);
    }

    function checkAnswer() {
      const current = [...dropZone.children].map(slot => slot.children[0]?.textContent || "").join(" ").trim();
      [...dropZone.children].forEach((slot, idx) => {
        const el = slot.children[0];
        if (el) {
          el.classList.remove("correct", "wrong");
          el.classList.add(el.textContent === words[idx] ? "correct" : "wrong");
        }
      });
      if (current === sentence) {
        tick.style.display = "block";
        score++;
        totalSentences++;
        scoreDisplay.innerHTML = `üçì ${score} points`;
        missionTracker.textContent = `Mission: ${totalSentences} / ${currentSet.length} sentences`;
        document.getElementById("nextBtn").style.display = "inline-block";
        speakSentence();
      } else {
        tick.style.display = "none";
      }
    }

    function showHint() {
      const firstWord = words[0];
      const hintEl = [...wordBank.children].find(el => el.textContent === firstWord);
      const firstSlot = [...dropZone.children][0];
      if (hintEl && firstSlot && firstSlot.children.length === 0) {
        firstSlot.appendChild(hintEl);
        checkAnswer();
      }
    }

    function speakSentence() {
      const utterance = new SpeechSynthesisUtterance(sentence);
      const voices = speechSynthesis.getVoices();
      const aussieVoice = voices.find(v => v.lang === 'en-AU');
      if (aussieVoice) utterance.voice = aussieVoice;
      speechSynthesis.speak(utterance);
    }

    function replayAudio() {
      const current = [...dropZone.children].map(slot => slot.children[0]?.textContent || "").join(" ").trim();
      if (current === sentence) {
        speakSentence();
      }
    }

    window.speechSynthesis.onvoiceschanged = () => {};
  </script>
</body>
</html>
